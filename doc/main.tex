\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{textcomp}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
%\usepackage{subfigure}
\usepackage{parskip}
\usepackage{hyperref}
\usepackage{color}
\usepackage{pdfpages}
\usepackage{pgf}
\usepackage{tikz}
\usepackage{amsfonts}
\usepackage{float}
\usepackage{cleveref}
\usepackage{multirow}
\usepackage{pdflscape}
\usepackage{rotating}
\usepackage{amsmath}
\usepackage{tablefootnote}
\usepackage{soul}
\restylefloat{table}
\usetikzlibrary{arrows,automata}

\begin{document}
\begin{titlepage}
			\begin{center}
			\textsc{\LARGE {IN4391 - Distributed Computing Systems}}\\[1cm]
			\rule{\linewidth}{0.5mm} \\[0.4cm]

			{\Huge \bfseries Large Lab Exercise B}\\[0.15cm]

			\rule{\linewidth}{0.5mm} \\
			\textsc{\large{The Dragons Arena System}}
			
				\rule{\linewidth}{0.5mm}
			
			\vskip 0.5 cm
			
			\begin{minipage}{0.4\textwidth}
				\begin{flushleft} \large
					\emph{Authors:}\\
					\begin{tabular}{l}
						Q. Stokkink (4016270) \\
						J.E.T. Tan (4032918)\\
					\end{tabular}
				\end{flushleft}
			\end{minipage}
			\hspace{1cm}
			\begin{minipage}{0.4\textwidth}
				\begin{flushright} \large
					\emph{Support Cast:} \\
					Dr.Ir. A. Iousup \\
					Ir. Y. Guo
				\end{flushright}
			\end{minipage}
			
			\vskip 0.5 cm
			
			\rule{\linewidth}{0.5mm}
			\end{center}
\end{titlepage}

\section{Abstract}
\label{sec:abstract}

Here comes the abstract...

\section{Introduction}
\label{sec:intro}

Massive Multiplayer Online Games (MMOG) are games that require player-to-player or player-to-environment interactions with players all over the world.
Each player also have their own platform (Desktop, laptop, tablet, smartphone or game console) with different hardware and different performance capacities.
Furthermore, the amount of players online is not known beforehand.
Because of this, game developers cannot rely on a traditional central server anymore.
Distributed computing solutions are commonly used nowadays in Massive Multiplayer Online Games (MMOG) because of their reliability,
scalability and predictable high performance compared to having a central server.

In this report, we describe the Dragons Arena System's (DAS) game engine,
a distributed game engine written in Java that allows us to scale the system according to the amount of players and synchronizes the action of each player with multiple servers.
The remainder of this report is divided as follows: in section 3, we provide background information about DAS.
In section 4, we present our system design of the distributed game engine behind it.
We then present our experimental results in section 5 and discuss them in section 6.
Finally, we conclude the report in section 7.


\section{Background on Application}
\label{sec:background}

In this section, we will shortly describe background information about the DAS application and the requirements stated for the game engine behind it.

DAS is an online warfare in which the world is a grid battlefield of 25x25 squares.
In this battlefield, dragons and knights (players) battle each other until the strongest race survives.

To implement a distributed game engine of DAS, the following requirements have been proposed:

\begin{itemize}
	\item Since it is difficult to test the system with real players, it has to be emulated (i.e. players take a simple strategy where they heal a nearby player with low health or attack a dragon otherwise)
	\item Clients and server nodes could crash at any time and restart. To handle this, all events must be logged in the order in which they occur on at least 2 server nodes
	\item The DAS application must be tested with any number of players up to 100 and up to 20 dragons with 5 server nodes
\end{itemize}


\section{System Design}
\label{sec:design}

In this section, we will present our design of the system.
To meet the scalability requirements, we have chosen to adapt a Condor-like architecture for load balancing \hl{add cite here}.
This involves servers advertising their number of connected clients to the \emph{central manager}.

A \emph{client} initially connects to a central manager to get an allocation of two \emph{execution machines} which will further handle all requests from this client.
The central manager only keeps track of the total amount of clients connected throughout the whole system by monitoring the advertisements of the execution machines.
If one of the two execution machines of a client crashes, the other (backup) execution machine will allow the client to keep operating as usuall.
A new server is then allocated for the client so it once again has two servers to fall back on.
In the event both servers go down at once, the client will experience a short desynchronization.

One might think that relying on a central component like the central manager makes the system have single point of failure,
as opposed to the original Condor architecture, which also include submission machines.
In the Condor architecture, the central manager acts like a \emph{matchmaker} and matches jobs with machines.
It would then notify the submission machine that in turn starts a shadow process (representation of the remote job) on the execution machines.
In our architecture, we completely skip the steps involving the submission machine and let the client start its job on the allocated execution machines.

Each component of the system (central manager, execution machines and client) has a \emph{heartbeat} to let the rest system know that he is still alive.
This heartbeat is organized hierarchically so that there is no single overloaded point in the system.
As soon as a heartbeat is not received anymore from that particular component, we know that component has crashed.

To get a scalable design in terms of server state synchronization we have utilized a unidirectional ring.
This allows us to handle servers being added and dropped rather easily, as only one existing machine in the ring
will need to be updated for each of these events. An overview of the resulting system can be found in \autoref{fig:serverring}.

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.25]{serverring.png}
    \caption{Condor mapped to a server ring}
    \label{fig:serverring}
\end{figure}

\section{Experimental Results}
\label{sec:results}
Here we present our experimental results.

\section{Discussion}
\label{sec:discussion}
Discuss main findings!

\section{Conclusion}
\label{sec:conclusion}
In this project...

\newpage
\section*{Appendix}

\subsection*{A - Time Sheet}
\label{sec:appendix}



\end{document}
